type LoginResponse {
  access: String!
  refresh: String!
  user: User!
}

type User {
  id: Int!
  username: String!
  email: String!
  first_name: String
  last_name: String
  is_active: Boolean
  date_joined: String!
}

type SignupResponse {
  message: String!
  user: User!
}

type TokenRefresh {
  access: String!
  refresh: String!
}

type Query {
  me: User
    @rest(
      endpoint: "https://qnap-jiri.myqnapcloud.com/classic-models/api/auth/me/"
      headers: [
        { name: "Authorization", value: "Bearer ${JWT_TOKEN}" }
        { name: "Content-Type", value: "application/json" }
      ]
    )
}

type Mutation {
  login(username: String!, password: String!): LoginResponse
    @rest(
      method: POST
      endpoint: "https://qnap-jiri.myqnapcloud.com/classic-models/api/auth/login/"
      headers: [
        { name: "Content-Type", value: "application/json" }
      ]
      postbody: """
      {
        "username": "{{ .Get "username" }}",
        "password": "{{ .Get "password" }}"
      }
      """
      contenttype: "application/json"
    )

  signup(
    username: String!
    email: String!
    first_name: String!
    last_name: String!
    password: String!
    password_confirm: String!
  ): SignupResponse
    @rest(
      method: POST
      endpoint: "https://qnap-jiri.myqnapcloud.com/classic-models/api/auth/signup/"
      headers: [
        { name: "Content-Type", value: "application/json" }
      ]
      postbody: """
      {
        "username": "{{ .Get "username" }}",
        "email": "{{ .Get "email" }}",
        "first_name": "{{ .Get "first_name" }}",
        "last_name": "{{ .Get "last_name" }}",
        "password": "{{ .Get "password" }}",
        "password_confirm": "{{ .Get "password_confirm" }}"
      }
      """
      contenttype: "application/json"
    )

  refreshToken(refresh: String!): TokenRefresh
    @rest(
      method: POST
      endpoint: "https://qnap-jiri.myqnapcloud.com/classic-models/api/auth/refresh/"
      headers: [
        { name: "Content-Type", value: "application/json" }
      ]
      postbody: """
      {
        "refresh": "{{ .Get "refresh" }}"
      }
      """
      contenttype: "application/json"
    )

  logout(refresh: String!): Boolean
    @rest(
      method: POST
      endpoint: "https://qnap-jiri.myqnapcloud.com/classic-models/api/auth/logout/"
      headers: [
        { name: "Authorization", value: "Bearer ${JWT_TOKEN}" }
        { name: "Content-Type", value: "application/json" }
      ]
      postbody: """
      {
        "refresh": "{{ .Get "refresh" }}"
      }
      """
      contenttype: "application/json"
    )
}

